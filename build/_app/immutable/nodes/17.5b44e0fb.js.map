{"version":3,"file":"17.5b44e0fb.js","sources":["../../../../../../src/routes/auth/+page.svelte"],"sourcesContent":["<script>\r\n\timport { goto } from '$app/navigation';\r\n\timport { userSignIn, userSignUp } from '$lib/apis/auths';\r\n\timport Spinner from '$lib/components/common/Spinner.svelte';\r\n\timport { WEBUI_API_BASE_URL, WEBUI_BASE_URL } from '$lib/constants';\r\n\timport { WEBUI_NAME, config, user, socket } from '$lib/stores';\r\n\timport { onMount, getContext } from 'svelte';\r\n\timport { toast } from 'svelte-sonner';\r\n\timport { generateInitialsImage, canvasPixelTest } from '$lib/utils';\r\n\r\n\tconst i18n = getContext('i18n');\r\n\r\n\tlet loaded = false;\r\n\tlet mode = 'signin';\r\n\r\n\tlet name = '';\r\n\tlet email = '';\r\n\tlet password = '';\r\n\r\n\tconst setSessionUser = async (sessionUser) => {\r\n\t\tif (sessionUser) {\r\n\t\t\tconsole.log(sessionUser);\r\n\t\t\ttoast.success($i18n.t(`You're now logged in.`));\r\n\t\t\tlocalStorage.token = sessionUser.token;\r\n\r\n\t\t\t$socket.emit('user-join', { auth: { token: sessionUser.token } });\r\n\t\t\tawait user.set(sessionUser);\r\n\t\t\tgoto('/');\r\n\t\t}\r\n\t};\r\n\r\n\tconst signInHandler = async () => {\r\n\t\tconst sessionUser = await userSignIn(email, password).catch((error) => {\r\n\t\t\ttoast.error(error);\r\n\t\t\treturn null;\r\n\t\t});\r\n\r\n\t\tawait setSessionUser(sessionUser);\r\n\t};\r\n\r\n\tconst signUpHandler = async () => {\r\n\t\tconst sessionUser = await userSignUp(name, email, password, generateInitialsImage(name)).catch(\r\n\t\t\t(error) => {\r\n\t\t\t\ttoast.error(error);\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t);\r\n\r\n\t\tawait setSessionUser(sessionUser);\r\n\t};\r\n\r\n\tconst submitHandler = async () => {\r\n\t\tif (mode === 'signin') {\r\n\t\t\tawait signInHandler();\r\n\t\t} else {\r\n\t\t\tawait signUpHandler();\r\n\t\t}\r\n\t};\r\n\r\n\tonMount(async () => {\r\n\t\tif ($user !== undefined) {\r\n\t\t\tawait goto('/');\r\n\t\t}\r\n\t\tloaded = true;\r\n\t\tif (($config?.features.auth_trusted_header ?? false) || $config?.features.auth === false) {\r\n\t\t\tawait signInHandler();\r\n\t\t}\r\n\t});\r\n</script>\r\n\r\n<svelte:head>\r\n\t<title>\r\n\t\t{`${$WEBUI_NAME}`}\r\n\t</title>\r\n</svelte:head>\r\n\r\n{#if loaded}\r\n\t<div class=\"fixed m-10 z-50\">\r\n\t\t<div class=\"flex space-x-2\">\r\n\t\t\t<div class=\" self-center\">\r\n\t\t\t\t<img\r\n\t\t\t\t\tcrossorigin=\"anonymous\"\r\n\t\t\t\t\tsrc=\"{WEBUI_BASE_URL}/static/favicon.png\"\r\n\t\t\t\t\tclass=\" w-8 rounded-full\"\r\n\t\t\t\t\talt=\"logo\"\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t<div class=\" bg-white dark:bg-gray-950 min-h-screen w-full flex justify-center font-mona\">\r\n\t\t<!-- <div class=\"hidden lg:flex lg:flex-1 px-10 md:px-16 w-full bg-yellow-50 justify-center\">\r\n\t\t\t<div class=\" my-auto pb-16 text-left\">\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<div class=\" font-bold text-yellow-600 text-4xl\">\r\n\t\t\t\t\t\tGet up and running with <br />large language models, locally.\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"mt-2 text-yellow-600 text-xl\">\r\n\t\t\t\t\t\tRun Llama 2, Code Llama, and other models. Customize and create your own.\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div> -->\r\n\r\n\t\t<div class=\"w-full sm:max-w-md px-10 min-h-screen flex flex-col text-center\">\r\n\t\t\t{#if ($config?.features.auth_trusted_header ?? false) || $config?.features.auth === false}\r\n\t\t\t\t<div class=\" my-auto pb-10 w-full\">\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tclass=\"flex items-center justify-center gap-3 text-xl sm:text-2xl text-center font-bold dark:text-gray-200\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t{$i18n.t('Signing in')}\r\n\t\t\t\t\t\t\t{$i18n.t('to')}\r\n\t\t\t\t\t\t\t{$WEBUI_NAME}\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<Spinner />\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t{:else}\r\n\t\t\t\t<div class=\"  my-auto pb-10 w-full dark:text-gray-100\">\r\n\t\t\t\t\t<form\r\n\t\t\t\t\t\tclass=\" flex flex-col justify-center\"\r\n\t\t\t\t\t\ton:submit|preventDefault={() => {\r\n\t\t\t\t\t\t\tsubmitHandler();\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<div class=\"mb-1\">\r\n\t\t\t\t\t\t\t<div class=\" text-2xl font-bold\">\r\n\t\t\t\t\t\t\t\t{mode === 'signin' ? $i18n.t('Sign in') : $i18n.t('Sign up')}\r\n\t\t\t\t\t\t\t\t{$i18n.t('to')}\r\n\t\t\t\t\t\t\t\t{$WEBUI_NAME}\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t{#if mode === 'signup'}\r\n\t\t\t\t\t\t\t\t<div class=\" mt-1 text-xs font-medium text-gray-500\">\r\n\t\t\t\t\t\t\t\t\tâ“˜ {$WEBUI_NAME}\r\n\t\t\t\t\t\t\t\t\t{$i18n.t(\r\n\t\t\t\t\t\t\t\t\t\t'does not make any external connections, and your data stays securely on your locally hosted server.'\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div class=\"flex flex-col mt-4\">\r\n\t\t\t\t\t\t\t{#if mode === 'signup'}\r\n\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t<div class=\" text-sm font-semibold text-left mb-1\">{$i18n.t('Name')}</div>\r\n\t\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\t\tbind:value={name}\r\n\t\t\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\t\t\tclass=\" px-5 py-3 rounded-2xl w-full text-sm outline-none border dark:border-none dark:bg-gray-900\"\r\n\t\t\t\t\t\t\t\t\t\tautocomplete=\"name\"\r\n\t\t\t\t\t\t\t\t\t\tplaceholder={$i18n.t('Enter Your Full Name')}\r\n\t\t\t\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t<hr class=\" my-3 dark:border-gray-900\" />\r\n\t\t\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t\t\t<div class=\"mb-2\">\r\n\t\t\t\t\t\t\t\t<div class=\" text-sm font-semibold text-left mb-1\">{$i18n.t('Email')}</div>\r\n\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\tbind:value={email}\r\n\t\t\t\t\t\t\t\t\ttype=\"email\"\r\n\t\t\t\t\t\t\t\t\tclass=\" px-5 py-3 rounded-2xl w-full text-sm outline-none border dark:border-none dark:bg-gray-900\"\r\n\t\t\t\t\t\t\t\t\tautocomplete=\"email\"\r\n\t\t\t\t\t\t\t\t\tplaceholder={$i18n.t('Enter Your Email')}\r\n\t\t\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t<div class=\" text-sm font-semibold text-left mb-1\">{$i18n.t('Password')}</div>\r\n\r\n\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\tbind:value={password}\r\n\t\t\t\t\t\t\t\t\ttype=\"password\"\r\n\t\t\t\t\t\t\t\t\tclass=\" px-5 py-3 rounded-2xl w-full text-sm outline-none border dark:border-none dark:bg-gray-900\"\r\n\t\t\t\t\t\t\t\t\tplaceholder={$i18n.t('Enter Your Password')}\r\n\t\t\t\t\t\t\t\t\tautocomplete=\"current-password\"\r\n\t\t\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div class=\"mt-5\">\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\tclass=\" bg-gray-900 hover:bg-gray-800 w-full rounded-2xl text-white font-semibold text-sm py-3 transition\"\r\n\t\t\t\t\t\t\t\ttype=\"submit\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{mode === 'signin' ? $i18n.t('Sign in') : $i18n.t('Create Account')}\r\n\t\t\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t\t\t{#if $config?.features.enable_signup}\r\n\t\t\t\t\t\t\t\t<div class=\" mt-4 text-sm text-center\">\r\n\t\t\t\t\t\t\t\t\t{mode === 'signin'\r\n\t\t\t\t\t\t\t\t\t\t? $i18n.t(\"Don't have an account?\")\r\n\t\t\t\t\t\t\t\t\t\t: $i18n.t('Already have an account?')}\r\n\r\n\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\tclass=\" font-medium underline\"\r\n\t\t\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\t\tif (mode === 'signin') {\r\n\t\t\t\t\t\t\t\t\t\t\t\tmode = 'signup';\r\n\t\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\t\tmode = 'signin';\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t{mode === 'signin' ? $i18n.t('Sign up') : $i18n.t('Sign in')}\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</form>\r\n\t\t\t\t</div>\r\n\t\t\t{/if}\r\n\t\t</div>\r\n\t</div>\r\n{/if}\r\n\r\n<style>\r\n\t.font-mona {\r\n\t\tfont-family: 'Mona Sans', -apple-system, 'Arimo', ui-sans-serif, system-ui, 'Segoe UI', Roboto,\r\n\t\t\tUbuntu, Cantarell, 'Noto Sans', sans-serif, 'Helvetica Neue', Arial, 'Apple Color Emoji',\r\n\t\t\t'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\r\n\t}\r\n</style>\r\n"],"names":["WEBUI_BASE_URL","_a","ctx","_b","insert_hydration","target","div2","anchor","div4","append_hydration","div3","t0_value","t14_value","if_block0","create_if_block_4","if_block1","create_if_block_3","create_if_block_2","div8","form","div1","div0","div6","input0","div5","input1","div7","button","dirty","set_data","t0","t2","t2_value","t8","t8_value","t11","t11_value","t14","div","t3","t3_value","input","hr","create_if_block","i18n","getContext","loaded","mode","name","email","password","setSessionUser","sessionUser","toast","$i18n","$socket","user","goto","signInHandler","userSignIn","error","signUpHandler","userSignUp","generateInitialsImage","submitHandler","onMount","$user","$$invalidate","$config"],"mappings":"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"}